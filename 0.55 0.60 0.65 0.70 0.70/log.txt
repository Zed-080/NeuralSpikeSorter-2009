(svenv) PS C:\Users\Zavier\OneDrive\Documents\Third Year\Modules\Computer_Engineering\Coursework\Source\Repos\NeuralSpikeSorter-2009> python main_runner.py
2025-12-05 09:39:39.283222: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-12-05 09:39:46.279363: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
=== Building Detector Dataset (Sequence Mode) ===
Loading Clean D1...
Building Matched Filter Template...

Applying Matched Filter, Normalizing & Extracting Windows...
Saved Detector Data: X=(104448, 128, 1) (Normalized & Matched Filtered)

=== Building Classifier Dataset ===
Loading D1 from D1.mat...
Building Matched Filter Template...
Extracting Classifier Waveforms (Matched Filtered & Normalized)...
Saved Classifier Data: X=(52224, 64, 1) (Normalized & Matched Filtered)

=== Training Detector (Sequence Model) ===
2025-12-05 09:40:05.375974: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Epoch 1/20
1306/1306 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 24s 14ms/step - accuracy: 0.9727 - loss: 0.0986 - val_accuracy: 0.9752 - val_loss: 0.0777
Epoch 2/20
1306/1306 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 20s 16ms/step - accuracy: 0.9754 - loss: 0.0753 - val_accuracy: 0.9761 - val_loss: 0.0734
Epoch 3/20
1306/1306 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 21s 16ms/step - accuracy: 0.9762 - loss: 0.0725 - val_accuracy: 0.9765 - val_loss: 0.0713
Epoch 4/20
1306/1306 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 36s 28ms/step - accuracy: 0.9768 - loss: 0.0705 - val_accuracy: 0.9771 - val_loss: 0.0698
Epoch 5/20
1306/1306 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 40s 30ms/step - accuracy: 0.9772 - loss: 0.0693 - val_accuracy: 0.9773 - val_loss: 0.0692
Epoch 6/20
1306/1306 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 45s 34ms/step - accuracy: 0.9775 - loss: 0.0682 - val_accuracy: 0.9776 - val_loss: 0.0677
Epoch 7/20
1306/1306 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 47s 36ms/step - accuracy: 0.9778 - loss: 0.0675 - val_accuracy: 0.9780 - val_loss: 0.0670
Epoch 8/20
1306/1306 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 43s 33ms/step - accuracy: 0.9779 - loss: 0.0669 - val_accuracy: 0.9781 - val_loss: 0.0665
Epoch 9/20
1306/1306 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 35s 27ms/step - accuracy: 0.9781 - loss: 0.0663 - val_accuracy: 0.9783 - val_loss: 0.0661
Epoch 10/20
1306/1306 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 36s 23ms/step - accuracy: 0.9782 - loss: 0.0660 - val_accuracy: 0.9784 - val_loss: 0.0658
Epoch 11/20
1306/1306 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 30s 23ms/step - accuracy: 0.9783 - loss: 0.0656 - val_accuracy: 0.9784 - val_loss: 0.0653
Epoch 12/20
1306/1306 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 33s 25ms/step - accuracy: 0.9784 - loss: 0.0652 - val_accuracy: 0.9785 - val_loss: 0.0650
Epoch 13/20
1306/1306 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 29s 22ms/step - accuracy: 0.9784 - loss: 0.0649 - val_accuracy: 0.9784 - val_loss: 0.0650
Epoch 14/20
1306/1306 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 31s 24ms/step - accuracy: 0.9784 - loss: 0.0648 - val_accuracy: 0.9783 - val_loss: 0.0648
Epoch 15/20
1306/1306 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 29s 22ms/step - accuracy: 0.9785 - loss: 0.0645 - val_accuracy: 0.9785 - val_loss: 0.0645
Epoch 16/20
1306/1306 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 30s 23ms/step - accuracy: 0.9785 - loss: 0.0644 - val_accuracy: 0.9786 - val_loss: 0.0641
Epoch 17/20
1306/1306 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 32s 24ms/step - accuracy: 0.9786 - loss: 0.0642 - val_accuracy: 0.9787 - val_loss: 0.0643
Epoch 18/20
1306/1306 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 29s 22ms/step - accuracy: 0.9786 - loss: 0.0640 - val_accuracy: 0.9787 - val_loss: 0.0638
Epoch 19/20
1306/1306 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 37s 28ms/step - accuracy: 0.9787 - loss: 0.0639 - val_accuracy: 0.9787 - val_loss: 0.0636
Epoch 20/20
1306/1306 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 40s 30ms/step - accuracy: 0.9787 - loss: 0.0637 - val_accuracy: 0.9788 - val_loss: 0.0639
Detector model saved to: outputs/spike_detector_model.keras

=== Training Classifier ===
Epoch 1/20
653/653 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 43s 43ms/step - accuracy: 0.7520 - loss: 0.8076 - val_accuracy: 0.8766 - val_loss: 0.4783
Epoch 2/20
653/653 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 29s 44ms/step - accuracy: 0.8632 - loss: 0.4776 - val_accuracy: 0.8877 - val_loss: 0.3717
Epoch 3/20
653/653 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 32s 49ms/step - accuracy: 0.8771 - loss: 0.4114 - val_accuracy: 0.8906 - val_loss: 0.3399
Epoch 4/20
653/653 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 39s 60ms/step - accuracy: 0.8818 - loss: 0.3830 - val_accuracy: 0.8957 - val_loss: 0.3201
Epoch 5/20
653/653 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 34s 52ms/step - accuracy: 0.8876 - loss: 0.3612 - val_accuracy: 0.8984 - val_loss: 0.3058
Epoch 6/20
653/653 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 8s 12ms/step - accuracy: 0.8894 - loss: 0.3483 - val_accuracy: 0.8974 - val_loss: 0.3016
Epoch 7/20
653/653 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 7s 11ms/step - accuracy: 0.8919 - loss: 0.3358 - val_accuracy: 0.9010 - val_loss: 0.2910
Epoch 8/20
653/653 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 9s 14ms/step - accuracy: 0.8952 - loss: 0.3276 - val_accuracy: 0.9023 - val_loss: 0.2839
Epoch 9/20
653/653 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 10s 15ms/step - accuracy: 0.8956 - loss: 0.3198 - val_accuracy: 0.9057 - val_loss: 0.2778
Epoch 10/20
653/653 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 8s 12ms/step - accuracy: 0.8990 - loss: 0.3098 - val_accuracy: 0.9073 - val_loss: 0.2712
Epoch 11/20
653/653 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 10s 15ms/step - accuracy: 0.9000 - loss: 0.3025 - val_accuracy: 0.9060 - val_loss: 0.2699
Epoch 12/20
653/653 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 13s 19ms/step - accuracy: 0.9007 - loss: 0.2980 - val_accuracy: 0.9067 - val_loss: 0.2653
Epoch 13/20
653/653 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 8s 12ms/step - accuracy: 0.9031 - loss: 0.2899 - val_accuracy: 0.9089 - val_loss: 0.2623
Epoch 14/20
653/653 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 7s 10ms/step - accuracy: 0.9029 - loss: 0.2894 - val_accuracy: 0.9071 - val_loss: 0.2579
Epoch 15/20
653/653 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 9s 13ms/step - accuracy: 0.9042 - loss: 0.2845 - val_accuracy: 0.9082 - val_loss: 0.2557
Epoch 16/20
653/653 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 10s 15ms/step - accuracy: 0.9049 - loss: 0.2804 - val_accuracy: 0.9092 - val_loss: 0.2492
Epoch 17/20
653/653 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 7s 10ms/step - accuracy: 0.9076 - loss: 0.2731 - val_accuracy: 0.9121 - val_loss: 0.2496
Epoch 18/20
653/653 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 7s 11ms/step - accuracy: 0.9067 - loss: 0.2763 - val_accuracy: 0.9117 - val_loss: 0.2536
Epoch 19/20
653/653 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 10s 15ms/step - accuracy: 0.9082 - loss: 0.2691 - val_accuracy: 0.9130 - val_loss: 0.2432
Epoch 20/20
653/653 â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 9s 13ms/step - accuracy: 0.9094 - loss: 0.2650 - val_accuracy: 0.9131 - val_loss: 0.2446
Classifier model saved to: outputs/spike_classifier_model.keras

ğŸ‰ TRAINING COMPLETE ğŸ‰
You can now run main_infer.py to generate predictions.

--- Processing D2.mat ---

=== Processing D2 ===
Denoising D2...

Denoising D2...
Building matched filter template from D1...
Using threshold: 0.55 for D2
Running sliding window detector...
Classifying...
Saved 1986 spikes to outputs\predictions\D2.mat

--- Processing D3.mat ---

=== Processing D3 ===
Denoising D3...

Denoising D3...
Using threshold: 0.6 for D3
Running sliding window detector...
Classifying...
Saved 1905 spikes to outputs\predictions\D3.mat

--- Processing D4.mat ---

=== Processing D4 ===
Denoising D4...

Denoising D4...
Using threshold: 0.65 for D4
Running sliding window detector...
Classifying...
Saved 1622 spikes to outputs\predictions\D4.mat

--- Processing D5.mat ---

=== Processing D5 ===
Denoising D5...

Denoising D5...
Using threshold: 0.7 for D5
Running sliding window detector...
Classifying...
Saved 1036 spikes to outputs\predictions\D5.mat

--- Processing D6.mat ---

=== Processing D6 ===
Denoising D6...

Denoising D6...
Using threshold: 0.7 for D6
Running sliding window detector...
Classifying...
Saved 1061 spikes to outputs\predictions\D6.mat
--------------------------------------------------
STARTING SUBMISSION PREPARATION
SUCCESS: Submission ZIP created: NeuralSpikeSorter_Submission.zip